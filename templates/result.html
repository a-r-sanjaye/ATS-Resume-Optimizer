<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ATS Results</title>
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
        }

        h2,
        h3 {
            text-align: center;
            color: #1E90FF;
        }

        .box {
            background: #111;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            margin-top: 15px;
        }

        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            background: #222;
            padding: 15px;
            border-radius: 5px;
            color: #ddd;
            line-height: 1.5;
        }

        .back {
            display: inline-block;
            margin-top: 20px;
            color: #1E90FF;
            text-decoration: none;
            font-weight: bold;
        }

        /* Gauge Styles */
        .score-container {
            margin: 10px;
        }

        .circular-chart {
            display: block;
            margin: 10px auto;
            max-width: 80%;
            max-height: 150px;
        }

        .circle-bg {
            fill: none;
            stroke: #333;
            stroke-width: 3.8;
        }

        .circle {
            fill: none;
            stroke-width: 2.8;
            stroke-linecap: round;
            animation: progress 1s ease-out forwards;
            stroke: #1E90FF;
            /* Default Color */
        }

        .percentage {
            fill: #fff;
            font-family: sans-serif;
            font-weight: bold;
            font-size: 0.5em;
            text-anchor: middle;
        }

        @keyframes progress {
            0% {
                stroke-dasharray: 0 100;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h2>ATS Analysis Result</h2>
        <div class="box" style="display: flex; justify-content: space-around; align-items: center; text-align: center;">
            <div class="score-container">
                <h3>Original Score</h3>
                <div class="gauge" style="--score: {{ score }}; --color: #ff4d4d;">
                    <svg viewBox="0 0 36 36" class="circular-chart">
                        <path class="circle-bg"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <path class="circle" stroke-dasharray="{{ score }}, 100"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <text x="18" y="20.35" class="percentage">{{ score }}%</text>
                    </svg>
                </div>
            </div>

            <div class="arrow" style="font-size: 2em; color: #555;">âžœ</div>

            <div class="score-container">
                <h3>Improved Score</h3>
                <div class="gauge" style="--score: {{ improved_score }}; --color: #4caf50;">
                    <svg viewBox="0 0 36 36" class="circular-chart">
                        <path class="circle-bg"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <path class="circle" style="stroke: #4caf50;"
                            stroke-dasharray="{{ improved_score if improved_score != 'N/A' else 0 }}, 100"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <text x="18" y="20.35" class="percentage">{{ improved_score }}%</text>
                    </svg>
                </div>
            </div>
        </div>
        <div class="box">
            <h3>Matched Keywords</h3>
            <pre>{{ keywords | join(', ') }}</pre>
        </div>
        <div class="box">
            <h3>Improved Resume Suggestions</h3>
            <div style="background:#222; padding:15px; border-radius:5px; color: #ddd; line-height: 1.5;">
                {% if improved_resume is mapping %}
                {% for key, value in improved_resume.items() %}
                <p><strong>{{ key }}:</strong> {{ value }}</p>
                {% endfor %}
                {% else %}
                <pre>{{ improved_resume }}</pre>
                {% endif %}
            </div>
        </div>
        <div class="box">
            <h3>Detailed ATS Report</h3>
            <pre>{{ ats_report }}</pre>
        </div>
        <div style="margin-top:20px; text-align:center;">
            <a class="back" href="/">â¬… Back to Home</a>
            <span style="margin:0 10px; color:#555;">|</span>
            <a class="back" href="/history">ðŸ•’ View Past Analyses</a>
            <span style="margin:0 10px; color:#555;">|</span>
            <a class="back" href="/download/{{ analysis_id }}">â¬‡ Download Original Resume</a>
            <span style="margin:0 10px; color:#555;">|</span>
            <a class="back" href="/download_improved/{{ analysis_id }}">âœ¨ Download Improved Resume (PDF)</a>
        </div>
    </div>
</body>

</html>